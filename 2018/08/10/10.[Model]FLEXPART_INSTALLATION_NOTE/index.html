<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>FLEXPART installation notes - 太平塔</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">








    <meta name="description" content="FLEXPART is a Lagrangian particle dispersion model (LPDM) developed by Norwegian Institute of Air Research, Norway. It allows researchers to simulate the long-range transportation, diffusion, dry&#x2F;wet">
<meta property="og:type" content="article">
<meta property="og:title" content="FLEXPART installation notes">
<meta property="og:url" content="http://envhyf.github.io/2018/08/10/10.[Model]FLEXPART_INSTALLATION_NOTE/index.html">
<meta property="og:site_name" content="太平塔">
<meta property="og:description" content="FLEXPART is a Lagrangian particle dispersion model (LPDM) developed by Norwegian Institute of Air Research, Norway. It allows researchers to simulate the long-range transportation, diffusion, dry&#x2F;wet">
<meta property="og:locale">
<meta property="og:image" content="http://envhyf.github.io/images/10.Flexpart_installation/Fig.1.png">
<meta property="article:published_time" content="2018-08-10T21:32:26.000Z">
<meta property="article:modified_time" content="2025-07-23T22:06:06.457Z">
<meta property="article:author" content="Hao Yufang">
<meta property="article:tag" content="Air quality">
<meta property="article:tag" content="Model">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://envhyf.github.io/images/10.Flexpart_installation/Fig.1.png">





<link rel="icon" href="/bugcatcher.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/agate.min.css">


<link rel="stylesheet" href="/css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116955364-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-116955364-1');
</script>


    


<meta name="generator" content="Hexo 6.1.0"></head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    太平塔
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">Archives</a>
            
            <a class="navbar-item "
               href="/categories/Research">Research</a>
            
            <a class="navbar-item "
               href="/categories/Tech">Tech</a>
            
            <a class="navbar-item "
               href="/categories/Life">Life</a>
            
            <a class="navbar-item "
               href="/about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="Suche" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" title="GitHub" target="_blank" rel="noopener" href="https://github.com/envhyf/">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            FLEXPART installation notes
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2018-08-10T21:32:26.000Z" itemprop="datePublished">8月 10 2018</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/Research/">Research</a>
        </span>
        
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <html><head></head><body><p>FLEXPART is a Lagrangian particle dispersion model (LPDM) developed by Norwegian Institute of Air Research, Norway. It allows researchers to simulate the long-range transportation, diffusion, dry/wet deposition processes of atmospheric spcecies from their sources.  It also can be utilized for backward calculation based on the observation of receptor to anaysis source-receptor relationships.</p>
<p>This model is coded following the Fortran 95 standard, and can be freely download from the page <a target="_blank" rel="noopener" href="https://www.flexpart.eu/">here</a>. Flexpart 8.x/9.x is easy for compilation following the offical <a target="_blank" rel="noopener" href="https://www.flexpart.eu/wiki/FpInstall">reference</a>.  I noticed that netCDF-format output (which would make the post-processing easier compared to the original binary output files) has been merged in the newer veision. Therefore, I tried to compile FLEXPART 10.0 beta version in the Linux system, while lots of issues appeared. My installing steps are listed as follows</p>
<span id="more"></span>



<p><img src="/../images/10.Flexpart_installation/Fig.1.png" alt="Fig1. Application example: Age composition of the plume"></p>
<p><em><font color="blue">Fig.1 Application example: CO age composition of the plume arrived at the receptor <a target="_blank" rel="noopener" href="http://www.cee.mtu.edu/~bzhang3/page1.html">source</a></font></em></p><font color="blue">
<h2 id="1-Installing-required-packages"><a href="#1-Installing-required-packages" class="headerlink" title=" 1. Installing required packages"></a><font color="blue"> 1. Installing required packages</font></h2><p>Compile flag “-fuse-linker-plugin” option is enabled in the makefile of flexaprt. The error <code>gfortran: error: -fuse-linker-plugin is not supported in this configuration</code> indicated that this option may not work  in the current system.  The website <a target="_blank" rel="noopener" href="https://www.cleancss.com/explain-command/arm-linux-gnueabi-gcc/67170">Explain Linux Commands</a> shows that:  </p>
<blockquote>
<p>Enables the use of a linker plugin during link-time optimization.  This option relies on the linker plugin support in linker that is available in gold or in GNU ld 2.21 or newer.</p>
</blockquote>
<p>Thus, I need to re-compile binutils to upgrade the GNU ld (my current version is 2.17 which is attched in Cent OS 5.9).  Later on, I have to re-compile all the required packages in theo order: binutils $\rightarrow$ gcc $\rightarrow$ netcdf-c/fortran $\rightarrow$ jasper $\rightarrow$ grib_api.    </p>
<p>(PS: since there are many softwares have been compiled in the current environment, I had to edit a new <code>~/.bashrc_forFlex</code> as an switch to select the suitable system configurations )</p>
<figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#Install binutils </span></span><br><span class="line"><span class="hljs-built_in">mkdir</span> /disk2/hyf/lib/build</span><br><span class="line"><span class="hljs-built_in">cd</span> /disk2/hyf/lib/build</span><br><span class="line">wget https://ftp.gnu.org/gnu/binutils/binutils-2.27.tar.gz</span><br><span class="line">tar -xvf binutils-2.27.tar.gz</span><br><span class="line"><span class="hljs-built_in">cd</span> binutils-2.27</span><br><span class="line">./configure prefix=/home/hli2/libs/binutils</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"><span class="hljs-built_in">cd</span> ../</span><br><span class="line"></span><br><span class="line">vi ~/.bashrc_forFLex</span><br><span class="line"><span class="hljs-built_in">export</span> DIR=/disk2/hyf/lib</span><br><span class="line"><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$DIR</span>/binutils-2.25/bin:<span class="hljs-variable">$PATH</span></span><br><span class="line"><span class="hljs-built_in">source</span> ~/.bashrc_forFLex</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">#Install gcc</span></span><br><span class="line"><span class="hljs-comment">#source code in https://ftp.gnu.org/gnu/gcc/</span></span><br><span class="line"><span class="hljs-comment">#Referenc in https://gcc.gnu.org/wiki/InstallingGCC</span></span><br><span class="line"><span class="hljs-built_in">cd</span> gcc-7.3.0</span><br><span class="line">./contrib/download_prerequisites</span><br><span class="line"><span class="hljs-built_in">cd</span> ..</span><br><span class="line"><span class="hljs-built_in">mkdir</span> objdir</span><br><span class="line"><span class="hljs-built_in">cd</span> objdir</span><br><span class="line">../gcc-6.1.0/configure --prefix=<span class="hljs-variable">$DIR</span>/gcc-6.1.0 --enable-languages=c,c++,fortran,go </span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">vi ~/.bashrc_forFlex</span><br><span class="line"><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$LD_LIBRARY_PATH</span>:<span class="hljs-variable">$DIR</span>/gcc-6.1.0/lib/../lib64</span><br><span class="line"><span class="hljs-built_in">export</span> PATH=/disk2/hyf/lib/gcc-6.1.0/bin:<span class="hljs-variable">$PATH</span></span><br><span class="line"><span class="hljs-built_in">export</span> CC=gcc</span><br><span class="line"><span class="hljs-comment">#export CFLAGS='-gdwarf-2 -gstrict-dwarf -02 -fPIC'</span></span><br><span class="line"><span class="hljs-built_in">export</span> CFLAGS=<span class="hljs-string">'-gdwarf-2 -gstrict-dwarf'</span></span><br><span class="line"><span class="hljs-built_in">export</span> CXX=g++</span><br><span class="line"><span class="hljs-built_in">export</span> FC=gfortran</span><br><span class="line"><span class="hljs-built_in">export</span> FCFLAGS=-m64</span><br><span class="line"><span class="hljs-built_in">export</span> F77=gfortran</span><br><span class="line"><span class="hljs-built_in">export</span> FFLAGS=-m64</span><br><span class="line"><span class="hljs-built_in">source</span> ~/.bashrc_forFlex</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">#Install netCDF</span></span><br><span class="line">wget ftp://ftp.unidata.ucar.edu/pub/netcdf/netcdf-4.6.1.tar.gz</span><br><span class="line">tar -zxvf netcdf-4.6.1.tar.gz</span><br><span class="line"><span class="hljs-built_in">cd</span> netcdf-4.6.1/</span><br><span class="line">wget <span class="hljs-string">'http://git.savannah.gnu.org/gitweb/?p=config.git;a=blob_plain;f=config.guess;hb=HEAD'</span> -O config.guess</span><br><span class="line">wget <span class="hljs-string">'http://git.savannah.gnu.org/gitweb/?p=config.git;a=blob_plain;f=config.sub;hb=HEAD'</span> -O config.sub</span><br><span class="line">./configure --prefix=/disk2/hyf/netcdf-4.6.1 CPPFLAGS=<span class="hljs-string">"-I/disk2/hyf/lib/hdf5/include -I/diks2/hyf/lib/grib2/include -O3"</span> LDFLAGS=<span class="hljs-string">"-L/disk2/hyf/lib/hdf5/lib -L/diks2/hyf/lib/grib2/lib"</span> --enable-shared --enable-netcdf-4  --disable-dap --disable-doxygen</span><br><span class="line">make -j</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">vi~/.bashrc_forFlex</span><br><span class="line"><span class="hljs-built_in">export</span> PATH=<span class="hljs-string">"<span class="hljs-variable">$DIR</span>/netcdf-4.6.1/bin:<span class="hljs-variable">$PATH</span>"</span></span><br><span class="line"><span class="hljs-built_in">export</span> NETCDF=<span class="hljs-variable">$DIR</span>/netcdf-4.6.1</span><br><span class="line"><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$LD_LIBRARY_PATH</span>:<span class="hljs-variable">$NETCDF</span>/lib</span><br><span class="line"><span class="hljs-built_in">export</span> CFLAGS=<span class="hljs-string">"-L<span class="hljs-variable">$HDF5</span>/lib -I<span class="hljs-variable">$HDF5</span>/include -L<span class="hljs-variable">$NETCDF</span>/lib -I<span class="hljs-variable">$NETCDF</span>/include"</span></span><br><span class="line"><span class="hljs-built_in">export</span> CXXFLAGS=<span class="hljs-string">"-L<span class="hljs-variable">$HDF5</span>/lib -I<span class="hljs-variable">$HDF5</span>/include -L<span class="hljs-variable">$NETCDF</span>/lib -I<span class="hljs-variable">$NETCDF</span>/include"</span></span><br><span class="line">xport FCFLAGS=<span class="hljs-string">"-L<span class="hljs-variable">$HDF5</span>/lib -I<span class="hljs-variable">$HDF5</span>/include -L<span class="hljs-variable">$NETCDF</span>/lib -I<span class="hljs-variable">$NETCDF</span>/include"</span></span><br><span class="line"><span class="hljs-built_in">export</span> CPPFLAGS=<span class="hljs-string">"-I<span class="hljs-variable">${HDF5}</span>/include -I<span class="hljs-variable">${NETCDF}</span>/include"</span></span><br><span class="line"><span class="hljs-built_in">export</span> LDFLAGS=<span class="hljs-string">"-L<span class="hljs-variable">${HDF5}</span>/lib -L<span class="hljs-variable">${NETCDF}</span>/lib"</span></span><br><span class="line"><span class="hljs-built_in">source</span> ~/.bashrc_forFlex</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">#Install netCDF-Fortran</span></span><br><span class="line">wget ftp://ftp.unidata.ucar.edu/pub/netcdf/netcdf-fortran-4.4.4.tar.gz</span><br><span class="line">tar -zxvf netcdf-fortran-4.4.4.tar.gz</span><br><span class="line">./configure  --prefix=<span class="hljs-variable">${NETCDF}</span> --enable-shared --disable-doxygen</span><br><span class="line">make -j</span><br><span class="line">make check</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">#Install jasper</span></span><br><span class="line">./configure --prefix=<span class="hljs-variable">$DIR</span>/jasper</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">vi~/.bashrc_forFlex</span><br><span class="line"><span class="hljs-built_in">export</span> JASPER=<span class="hljs-variable">$DIR</span>/jasper</span><br><span class="line"><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$LD_LIBRARY_PATH</span>:<span class="hljs-variable">$JASPER</span>/lib</span><br><span class="line"><span class="hljs-built_in">source</span> ~/.bashrc_forFlex</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">#Install grib_api</span></span><br><span class="line"><span class="hljs-comment">#download page https://confluence.ecmwf.int/display/GRIB/Releases</span></span><br><span class="line">./configure --prefix=<span class="hljs-variable">$DIR</span>/grib_api --with-jasper=<span class="hljs-variable">$DIR</span>/jasper --disable-shared <span class="hljs-comment"># --enable-sharedv</span></span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"><span class="hljs-comment">#Noted that if disable-shared is not added into the compile flag, the error "/disk2/hyf/lib/jasper/lib/libjasper.a: error adding symbols: Bad value" would appear.  </span></span><br><span class="line"></span><br><span class="line">vi ~/.bashrc_forFlex</span><br><span class="line"><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$GRIB_API_BIN</span>:<span class="hljs-variable">$PATH</span></span><br><span class="line"><span class="hljs-built_in">export</span> GRIB_API=<span class="hljs-variable">$DIR</span>/grib_api/</span><br><span class="line"><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$LD_LIBRARY_PATH</span>:<span class="hljs-variable">$GRIB_API</span>/lib</span><br><span class="line"><span class="hljs-built_in">export</span> GRIB_API_BIN=<span class="hljs-variable">$GRIB_API</span>/bin</span><br><span class="line"><span class="hljs-built_in">export</span> GRIB_API_LIB=<span class="hljs-variable">$GRIB_API</span>/lib</span><br><span class="line"><span class="hljs-built_in">export</span> GRIB_API_INCLUDE=<span class="hljs-variable">$GRIB_API</span>/include</span><br><span class="line"><span class="hljs-built_in">source</span> ~/.bashrc_forFlex</span><br></pre></td></tr></tbody></table></figure>



<h2 id="2-Installing-FLEXPART"><a href="#2-Installing-FLEXPART" class="headerlink" title=" 2. Installing FLEXPART"></a><font color="blue"> 2. Installing FLEXPART</font></h2><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#edit the makefile suitable for the own computer</span></span><br><span class="line"><span class="hljs-comment">#dowanload page: https://www.flexpart.eu/downloads</span></span><br><span class="line">tar -xvzf flexpart10.01beta.tar.gz</span><br><span class="line"><span class="hljs-built_in">cd</span> ./flexpart10.01beta/flexpart</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment"># Both ECMWF and GFS data can be used as the inputs for FLEXPART, while the specific model for them should be clarified befoe installation.   </span></span><br><span class="line"><span class="hljs-built_in">cp</span> -r src/ test1/</span><br><span class="line"><span class="hljs-built_in">cd</span> test1</span><br><span class="line"></span><br><span class="line">vi Makefile</span><br><span class="line"><span class="hljs-comment"># the lines below should be revised depending on the own computer system.   </span></span><br><span class="line">F90       = <span class="hljs-variable">$GCC</span>/gcc-6.1.0/bin/gfortran</span><br><span class="line">INCPATH1  = /disk2/hyf/lib/grib_api/include</span><br><span class="line">INCPATH2  = /disk2/hyf/lib/jasper/include</span><br><span class="line">INCPATH3  = /disk2/hyf/lib/netcdf-4.6.1/include</span><br><span class="line">LIBPATH1  = /disk2/hyf/lib/grib_api/lib</span><br><span class="line">LIBPATH2  = /disk2/hyf/lib/jasper/lib</span><br><span class="line">LIBPATH3  = /disk2/hyf/lib/netcdf-4.6.1/lib</span><br><span class="line"></span><br><span class="line">vi par_mod.f90</span><br><span class="line"><span class="hljs-comment"># the default parameters in the par_mod.f90 was set for ECMWF windfield datasets. Therefore, some lines need to be revised. </span></span><br><span class="line"><span class="hljs-comment"># Adjust the following parameters to switch between FNL/ECMWF datasets.</span></span><br><span class="line">!<span class="hljs-built_in">integer</span>,parameter :: nxmax=361,nymax=181,nuvzmax=92,nwzmax=92,nzmax=92 !FNL XF</span><br><span class="line">!<span class="hljs-built_in">integer</span>,parameter :: nxmax=361,nymax=181,nuvzmax=152,nwzmax=152,nzmax=152 !ECMWF new </span><br><span class="line">!<span class="hljs-built_in">integer</span>,parameter :: nxmax=361,nymax=181,nuvzmax=92,nwzmax=92,nzmax=92 !ECMWF</span><br><span class="line">!<span class="hljs-built_in">integer</span>,parameter :: nxmax=361,nymax=181,nuvzmax=26,nwzmax=26,nzmax=26</span><br><span class="line"><span class="hljs-built_in">integer</span>,parameter :: nxmax=721,nymax=361,nuvzmax=64,nwzmax=64,nzmax=64</span><br><span class="line">!<span class="hljs-built_in">integer</span>,parameter :: nxmax=1201,nymax=235,nuvzmax=58,nwzmax=58,nzmax=58</span><br><span class="line"></span><br><span class="line">!<span class="hljs-built_in">integer</span>,parameter :: nxshift=359 ! <span class="hljs-keyword">for</span> ECMWF</span><br><span class="line"><span class="hljs-built_in">integer</span>,parameter :: nxshift=0     ! <span class="hljs-keyword">for</span> GFS or FNL</span><br><span class="line"></span><br><span class="line">make -j 8 gfs</span><br></pre></td></tr></tbody></table></figure>



<h2 id="3-Installing-FLEXPART-WRF"><a href="#3-Installing-FLEXPART-WRF" class="headerlink" title=" 3. Installing FLEXPART-WRF"></a><font color="blue"> 3. Installing FLEXPART-WRF</font></h2><p>It has been known that the results of Lagrangian particle dispersion models (LPDM) would affected by the errors in spatio-temporal interpolation of the simulated meteorological field. Furthermore, there are some uncertainties in the aspect of simulating mixing status for particles due to the erros in the vertical velocity. Therefore, the output from mesoscale models which were finer in vertical/horizontial resolution and time interval have been introduced for partially address these issue. In 2006, Flexpart-WRF model has been developed  combining the Flexpart utilities and WRF output. Compared to the standard model using global GFS/ECMWF datasets, Flexpart-WRF can better depict the atmospheric transportation especially for small-scale applications.</p>
<figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tar -xvzf ./flexpart_wrf_3.3.2.tar.gz</span><br><span class="line"><span class="hljs-built_in">cd</span> flexpart_wrf</span><br><span class="line"><span class="hljs-built_in">cp</span> -r src <span class="hljs-built_in">test</span></span><br><span class="line"><span class="hljs-built_in">cd</span> <span class="hljs-built_in">test</span></span><br><span class="line"></span><br><span class="line">vi makefile.mom <span class="hljs-comment"># set the ${NETCDF} environment variable</span></span><br><span class="line">make -f makefile.mom omp</span><br><span class="line"></span><br><span class="line"><span class="hljs-comment">#Done!</span></span><br></pre></td></tr></tbody></table></figure>



<h2 id="4-Some-tips"><a href="#4-Some-tips" class="headerlink" title=" 4. Some tips"></a><font color="blue"> 4. Some tips</font></h2><figure class="highlight bash hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment"># Error1 NetCDF: Invalid dimension ID or name when using forward mode of FLEXPART-WRF</span></span><br><span class="line"><span class="hljs-comment"># REFERENCE: https://www.flexpart.eu/ticket/233</span></span><br><span class="line"><span class="hljs-comment"># There is a typo error in the original netcdf_out_mod.F90!</span></span><br><span class="line"></span><br><span class="line">Change Line 624</span><br><span class="line">- ncret = NF90_DEF_VAR(ncid,<span class="hljs-string">'DRYDEP'</span>,NF90_FLOAT,ncdimsid2,ncddvid,&amp;</span><br><span class="line">+ ncret = NF90_DEF_VAR(ncid,<span class="hljs-string">'DRYDEP'</span>,NF90_FLOAT,ncdimsid22,ncddvid,&amp;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>


<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://www.flexpart.eu/">1. FlXEXPART Offical website</a>  </p>
<p><a target="_blank" rel="noopener" href="https://jira.ecmwf.int/browse/SUP-373">2. Problem compiling GRIB AP</a></p>
<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/629961/how-can-i-set-ccshared-fpic-while-executing-configure">3. Compile with flag -fPIC</a></p>
<p><a target="_blank" rel="noopener" href="https://www.flexpart.eu/ticket/136">4. FLEXPART various compilation problems</a></p>
</font></body></html>
    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Air-quality/">#Air quality</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Model/">#Model</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Linux/">#Linux</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2018/09/04/11.%5BModel%5D%E6%B0%94%E8%B1%A1%E6%A8%A1%E6%8B%9FNetCDF%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6%E5%90%8E%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85/">在低版本Linux安装科学计算库的曲折之路</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2018/07/22/9.%5BCode%5DUseful%20python%20scripts%20for%20daily%20use/">Useful python scripts for daily uses</a>
            
        </span>
    </div>
    
</article>




<div class="comments">
    <h3 class="title is-4">Kommentare</h3>
    
<script>
    var disqus_config = function () {
        this.page.url = 'http://envhyf.github.io/2018/08/10/10.[Model]FLEXPART_INSTALLATION_NOTE/';
        this.page.identifier = '2018/08/10/10.[Model]FLEXPART_INSTALLATION_NOTE/';
        
        this.language = 'zh';
        
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'taipingta' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2025 Hao Yufang&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" target="_blank" rel="noopener" href="https://github.com/envhyf/">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery > p > .gallery-item').unwrap();
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    

    



<script src="/js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Suche etwas..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Seiten',
                CATEGORIES: 'Kategorien',
                TAGS: 'Tags',
                UNTITLED: '(Sin título)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="/js/insight.js"></script>

    
</body>
</html>
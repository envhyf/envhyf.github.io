<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head>
    <meta charset="utf-8">
<title>Plotting FLEXPART trajectories in 3D terrain map - 太平塔</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">








    <meta name="description" content="This blog post demonstrates how to plot FLEXPART model trajectories on a 3D terrain map, integrating topography and transport data for enhanced visualization. The workflow includes:  Loading terrain d">
<meta property="og:type" content="article">
<meta property="og:title" content="Plotting FLEXPART trajectories in 3D terrain map">
<meta property="og:url" content="http://envhyf.github.io/2024/10/05/30.FLEXPART-trajectories-in-3D-terrain-map/index.html">
<meta property="og:site_name" content="太平塔">
<meta property="og:description" content="This blog post demonstrates how to plot FLEXPART model trajectories on a 3D terrain map, integrating topography and transport data for enhanced visualization. The workflow includes:  Loading terrain d">
<meta property="og:locale">
<meta property="og:image" content="http://envhyf.github.io/images/30.FLEXPART_3D_Terrain/Fig.1.png">
<meta property="og:image" content="http://envhyf.github.io/images/30.FLEXPART_3D_Terrain/Fig.2.png">
<meta property="og:image" content="http://envhyf.github.io/images/30.FLEXPART_3D_Terrain/Fig.3.png">
<meta property="article:published_time" content="2024-10-05T18:15:26.000Z">
<meta property="article:modified_time" content="2025-08-04T06:39:19.138Z">
<meta property="article:author" content="Hao Yufang">
<meta property="article:tag" content="Air quality">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="Model">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://envhyf.github.io/images/30.FLEXPART_3D_Terrain/Fig.1.png">





<link rel="icon" href="/bugcatcher.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-dark.min.css">


<link rel="stylesheet" href="/css/style.css">


<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


    
    
    
    
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116955364-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-116955364-1');
</script>


    


<meta name="generator" content="Hexo 6.1.0"></head>
<body>
    
<nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/">
                
                    
                    太平塔
                    
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item "
               href="/archives">Archives</a>
            
            <a class="navbar-item "
               href="/categories/Research">Research</a>
            
            <a class="navbar-item "
               href="/categories/Tech">Tech</a>
            
            <a class="navbar-item "
               href="/categories/Life">Life</a>
            
            <a class="navbar-item "
               href="/about">About</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="Buscar" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" title="GitHub" target="_blank" rel="noopener" href="https://github.com/envhyf/">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            Plotting FLEXPART trajectories in 3D terrain map
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2024-10-05T18:15:26.000Z" itemprop="datePublished">10月 5 2024</time>
            
        </span>
        
        <span class="column is-narrow article-category">
            <i class="far fa-folder"></i>
            <a class="article-category-link" href="/categories/Research/">Research</a>
        </span>
        
        
        <span class="column is-narrow">
            
            
            10 分钟 de lectura (Alrededor de 1460 palabras)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <html><head></head><body><p>This blog post demonstrates how to plot FLEXPART model trajectories on a 3D terrain map, integrating topography and transport data for enhanced visualization. The workflow includes:</p>
<ul>
<li>Loading terrain data</li>
<li>Plotting air mass trajectories in 3D</li>
<li>Creating illustrative particle dispersion effects</li>
</ul>
<span id="more"></span>

<h2 id="1-Load-and-Visualize-Terrain-Data"><a href="#1-Load-and-Visualize-Terrain-Data" class="headerlink" title="1. Load and Visualize Terrain Data"></a>1. Load and Visualize Terrain Data</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import cartopy.crs as ccrs
import cartopy.feature as cfeature
from cartopy.io import shapereader
from netCDF4 import Dataset

# load the terrain file
etopo_file = "./../../../../../4.Punjab_fire/Analysis_notebook/ETOPO_2022_v1_60s_N90W180_bed.nc"  # Replace with your local ETOPO1 file
nc = Dataset(etopo_file)
# Extract data from ETOPO1
lon = nc.variables['lon'][:]
lat = nc.variables['lat'][:]
elevation = nc.variables['z'][:]

# Mask the ocean by setting all elevation &lt;= 0 (sea level or below) to NaN
elevation_masked = np.where(elevation &lt;= 0, np.nan, elevation)


# Extract the topo data to the area of interest
lon_min, lon_max = 60, 89
lat_min, lat_max = 22, 36
lon_indices = np.where((lon &gt;= lon_min) &amp; (lon &lt;= lon_max))[0]
lat_indices = np.where((lat &gt;= lat_min) &amp; (lat &lt;= lat_max))[0]

subset_lon = lon[lon_indices]
subset_lat = lat[lat_indices]
subset_elevation = elevation_masked[np.ix_(lat_indices, lon_indices)]

lon_grid, lat_grid = np.meshgrid(subset_lon,subset_lat)

# Normalize elevation data for better 3D visualization
elevation_normalized = np.clip(subset_elevation/ 1000, 0, subset_elevation.max()/1000.0)  # Convert to km


from matplotlib.colors import LinearSegmentedColormap
import shapefile
from shapely.geometry import Polygon
from shapely.geometry import mapping
from mpl_toolkits.mplot3d.art3d import Line3DCollection
from scipy.interpolate import RegularGridInterpolator

def truncate_colormap(cmap, minval=0.2, maxval=1.0, n=100):
    new_cmap = LinearSegmentedColormap.from_list(
        f"trunc({cmap.name},{minval:.2f},{maxval:.2f})",
        cmap(np.linspace(minval, maxval, n)),
    )
    return new_cmap

# Create a truncated terrain colormap starting from green
terrain_truncated = truncate_colormap(plt.cm.terrain, minval=0.3, maxval=1.0)

from matplotlib.colors import LinearSegmentedColormap
import shapefile
from shapely.geometry import Polygon
from shapely.geometry import mapping
from mpl_toolkits.mplot3d.art3d import Line3DCollection
from scipy.interpolate import RegularGridInterpolator

def truncate_colormap(cmap, minval=0.2, maxval=1.0, n=100):
    new_cmap = LinearSegmentedColormap.from_list(
        f"trunc({cmap.name},{minval:.2f},{maxval:.2f})",
        cmap(np.linspace(minval, maxval, n)),
    )
    return new_cmap

# Create a truncated terrain colormap starting from green
terrain_truncated = truncate_colormap(plt.cm.terrain, minval=0.3, maxval=1.0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a href="/images/30.FLEXPART_3D_Terrain/Fig.1.png"><img src="/images/30.FLEXPART_3D_Terrain/Fig.1.png" alt="enter image description here"></a>    </p>
<h2 id="2-Load-and-Plot-FLEXPART-Trajectories"><a href="#2-Load-and-Plot-FLEXPART-Trajectories" class="headerlink" title="2. Load and Plot FLEXPART Trajectories"></a>2. Load and Plot FLEXPART Trajectories</h2><p>In trajectory mode, the output txt format information can be seen here<br><a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/METV/FLEXPART+output">https://confluence.ecmwf.int/display/METV/FLEXPART+output</a></p>
<table>
<thead>
<tr>
<th>Column Number</th>
<th>Name</th>
<th>Unit</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>time</td>
<td>s</td>
<td>The elapsed time in seconds since the middle point of the release interval</td>
</tr>
<tr>
<td>2</td>
<td>meanLon</td>
<td>degrees</td>
<td>Mean longitude position for all the particles</td>
</tr>
<tr>
<td>3</td>
<td>meanLat</td>
<td>degrees</td>
<td>Mean latitude position for all the particles</td>
</tr>
<tr>
<td>4</td>
<td>meanZ</td>
<td>m</td>
<td>Mean height for all the particles (above sea level)</td>
</tr>
<tr>
<td>5</td>
<td>meanTopo</td>
<td>m</td>
<td>Mean topography underlying all the particles</td>
</tr>
<tr>
<td>6</td>
<td>meanPBL</td>
<td>m</td>
<td>Mean PBL (Planetary Boundary Layer) height for all the particles (above ground level)</td>
</tr>
<tr>
<td>7</td>
<td>meanTropo</td>
<td>m</td>
<td>Mean tropopause height at the positions of particles (above sea level)</td>
</tr>
<tr>
<td>8</td>
<td>meanPv</td>
<td>PVU</td>
<td>Mean potential vorticity for all the particles</td>
</tr>
<tr>
<td>9</td>
<td>rmsHBefore</td>
<td>km</td>
<td>Total horizontal RMS (root mean square) distance before clustering</td>
</tr>
<tr>
<td>10</td>
<td>rmsHAfter</td>
<td>km</td>
<td>Total horizontal RMS distance after clustering</td>
</tr>
<tr>
<td>11</td>
<td>rmsVBefore</td>
<td>m</td>
<td>Total vertical RMS distance before clustering</td>
</tr>
<tr>
<td>12</td>
<td>rmsVAfter</td>
<td>m</td>
<td>Total vertical RMS distance after clustering</td>
</tr>
<tr>
<td>13</td>
<td>pblFract</td>
<td>%</td>
<td>Fraction of particles in the PBL</td>
</tr>
<tr>
<td>14</td>
<td>pv2Fract</td>
<td>%</td>
<td>Fraction of particles with PV &lt; 2 PVU</td>
</tr>
<tr>
<td>15</td>
<td>tropoFract</td>
<td>%</td>
<td>Fraction of particles within the troposphere</td>
</tr>
<tr>
<td>16*</td>
<td>clLon_N</td>
<td>degrees</td>
<td>Mean longitude position for all the particles in cluster N</td>
</tr>
<tr>
<td>17*</td>
<td>clLat_N</td>
<td>degrees</td>
<td>Mean latitude position for all the particles in cluster N</td>
</tr>
<tr>
<td>18*</td>
<td>clZ_N</td>
<td>m</td>
<td>Mean height for all the particles in cluster N (above sea level)</td>
</tr>
<tr>
<td>19*</td>
<td>clFract_N</td>
<td>%</td>
<td>Fraction of particles in cluster N (above sea level)</td>
</tr>
<tr>
<td>20*</td>
<td>clRms_N</td>
<td>km</td>
<td>Total horizontal RMS distance in cluster N</td>
</tr>
</tbody></table>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">input_file = "./data/retroplume_raw/traj/clustered_ind/2018-03-30-example.txt"
with open(input_file, "r") as file:
    lines = file.readlines()[7:]
data = [list(map(float, line.split())) for line in lines]
df_traj = pd.DataFrame(data, columns=columns[:len(data[0])])  # Adjust column count based on the actual data length

# 36 hr in total
kp_traj = df_traj[df_traj['receptor'] == 1.0].reset_index(drop = True)
dl_traj = df_traj[df_traj['receptor'] == 2.0].reset_index(drop = True)


trajectories = {
    "KP": {
        "lon": kp_traj['meanLon'],
        "lat": kp_traj['meanLat'],
        "alt": kp_traj['meanZ']/1000.0 + kp_traj['meanTopo']/1000.0,
        "time_delta": -1*(kp_traj['time'] - kp_traj['time'].iloc[0])/60/60.0,
    },
    "DL": {
        "lon": dl_traj['meanLon'],
        "lat": dl_traj['meanLat'],
        "alt": dl_traj['meanZ']/1000.0 + dl_traj['meanTopo']/1000.0,
        'time_delta':-1*(kp_traj['time'] - kp_traj['time'].iloc[0])/60/60.0
    },
}


elevation_interpolator = RegularGridInterpolator(
    (lat, lon), elevation / 1000.0  # Convert elevation to km
)

def set_3d_background(ax,sel_df_bio):
    ax.scatter(
    80.331871, 26.449923, 0.35,  # Kanpur at ground level
    zdir="z",
    marker="s",
    facecolor='none',
    edgecolor="b",
    s=40,
    alpha=1,lw = 2,
    label="Kanpur",zorder = 3
    )
    ax.scatter(
        77.069710, 28.679079, 0.53,  # New Delhi at ground level
        zdir="z",
        marker="s",
        facecolor='none',
        edgecolor="r",
        s=40,
        alpha=1,lw = 2,
        label="New Delhi",zorder = 3
    )

    # Plot the real-world elevation data as the base map
    ax.plot_surface(
        lon_grid,
        lat_grid,
        subset_elevation/1000.0,
        cmap=plt.cm.gray,#terrain_truncated,
        rstride=10,
        cstride=10,
        edgecolor='none',
        alpha=0.15,
    )
    
    
    
    # Customize grid appearance
    ax.xaxis._axinfo["grid"]["color"] = (1, 1, 1, 0)  # Transparent X grid
    ax.yaxis._axinfo["grid"]["color"] = (1, 1, 1, 0)  # Transparent Y grid
    ax.zaxis._axinfo["grid"]["color"] = (1, 1, 1, 0)  # Transparent Z grid
    ax.set_xlim([lon_min,lon_max])
    ax.set_ylim([lat_min, lat_max])
    ax.set_xlabel("Longitude")
    ax.set_ylabel("Latitude")
    ax.set_zlabel("Altitude (km)")



def plot_individual_day_traj(ax,traj):
#     colors = ['#97ff80','#679b4e','#ffe64c','#cd4040','purple','k']
#     time_categories = [0, 12,24, 48, 72, 96, 120]  # 5 days (0-24, 24-48, etc.)
#     for i in range(len(time_categories) - 1):
#         mask = (traj["time_delta"] &gt;= time_categories[i]) &amp; (traj["time_delta"] &lt; time_categories[i + 1])
#         ax.plot(
#             np.array(traj["lon"])[mask],
#             np.array(traj["lat"])[mask],
#             np.array(traj["alt"])[mask],
#             color=colors[i],

#             linewidth=3.5,
#             label=f"&lt;{time_categories[i+1]} hr",
#         )
    norm = mcolors.Normalize(vmin=0, vmax=72)  # Assuming time_delta ranges from 0 to 48 hours
    cmap = cm.get_cmap('Spectral_r')  # Choose a continuous colormap

    # Plot trajectories with continuous color representation

    for i in range(len(traj["time_delta"]) - 1):
        ax.plot(
            traj["lon"][i:i+2],
            traj["lat"][i:i+2],
            traj["alt"][i:i+2],
            color=cmap(norm(traj["time_delta"][i])),  # Map time_delta to color
            linewidth=2.5,zorder =15,
        )

# Create a 3D plot
fig = plt.figure(figsize=(6, 5))

norm = mcolors.Normalize(vmin=0, vmax=72)  # Assuming time_delta ranges from 0 to 48 hours
cmap = cm.get_cmap('Spectral_r')  # Choose a continuous colormap

ax = fig.add_subplot(111, projection='3d')
plot_individual_day_traj(ax, trajectories['DL'])
set_3d_background_dl(ax,sel_df_bio)
ax.set_zlim([0, 7])
ax.set_title('Delhi', loc = 'left', fontweight = 'bold',y=0.85)
ax.legend(ncol = 3, loc = (0.55, 0.45), fontsize = 8, frameon=True)
ax.view_init(elev=21, azim=-110)  # 

plt.show()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a href="/images/30.FLEXPART_3D_Terrain/Fig.2.png"><img src="/images/30.FLEXPART_3D_Terrain/Fig.2.png" alt="enter image description here"></a>    </p>
<h2 id="3-Particle-Dispersion-Illustration"><a href="#3-Particle-Dispersion-Illustration" class="headerlink" title="3.Particle Dispersion Illustration"></a>3.Particle Dispersion Illustration</h2><pre class="line-numbers language-Python" data-language="Python"><code class="language-Python">import numpy as np

def plot_individual_day_traj_particles(ax, traj, n_particles=10, spread=0.05,initial_spread=0.05, final_spread=1):
    """
    Plot trajectory as particles instead of lines by generating points around the trajectory.
    
    Parameters:
    - ax: Matplotlib 3D axis.
    - traj: Dictionary with trajectory data (lon, lat, alt, time_delta).
    - n_particles: Number of particles to simulate per trajectory step.
    - spread: Standard deviation for particle dispersion around each step.
    """
    norm = mcolors.Normalize(vmin=0, vmax=72)  # Normalize time_delta
    cmap = cm.get_cmap('Spectral_r')  # Colormap for time
    
    # Loop through each trajectory point
    for i in range(len(traj["time_delta"])):
        
        current_spread = np.interp(
            traj["time_delta"][i], [0, max(traj["time_delta"])], [initial_spread, final_spread]
        )
        
        # Generate random offsets for particles
        lon_offsets = np.random.normal(traj["lon"][i], current_spread, n_particles)
        lat_offsets = np.random.normal(traj["lat"][i], current_spread, n_particles)
        alt_offsets = np.random.normal(traj["alt"][i], current_spread / 2, n_particles)  # Less spread for altitude
        
        # Get color for the current time_delta
        color = cmap(norm(traj["time_delta"][i]))
        
        # Plot the particles
        ax.scatter(
            lon_offsets,
            lat_offsets,
            alt_offsets,
            color=color,
            alpha=0.45,
            s=2,  # Small points for particles
        )


# Create a 3D plot
fig = plt.figure(figsize=(6, 5))

norm = mcolors.Normalize(vmin=0, vmax=72)  # Assuming time_delta ranges from 0 to 48 hours
cmap = cm.get_cmap('Spectral_r')  # Choose a continuous colormap

ax = fig.add_subplot(111, projection='3d')
plot_individual_day_traj_particles(ax, trajectories["DL"], n_particles=200, spread=0.25)
set_3d_background_dl(ax,df_pun)
ax.set_zlim([0, 7])
ax.set_title('Delhi', loc = 'left', fontweight = 'bold',y=0.85)
# ax.legend(ncol = 3, loc = (0.3, 0.7), fontsize = 8, frameon=True)
ax.view_init(elev=17, azim=-110)  # 

sm = cm.ScalarMappable(cmap=cmap, norm=norm)
axcolor = fig.add_axes([0.275, 0.6, 0.15, 0.015])  # Custom position and size for the colorbar axis
cbar = plt.colorbar(sm, cax=axcolor, orientation='horizontal')  # Create horizontal colorbar
cbar.set_label('Air Mass Transport Time (hr)', labelpad=-40, fontsize=9)     

plt.savefig("./Backward_trajectories_example_20181125_pollution_cases_particle_simulation_version.png", dpi =400)
plt.show()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a href="/images/30.FLEXPART_3D_Terrain/Fig.3.png"><img src="/images/30.FLEXPART_3D_Terrain/Fig.3.png" alt="enter image description here"></a>     </p>
</body></html>
    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Air-quality/">#Air quality</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Linux/">#Linux</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Model/">#Model</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/2024/10/11/31.%5BReading%5D%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-%E4%BA%A7%E4%B8%9A%E4%B8%8E%E6%96%87%E6%98%8E/">读书笔记-张笑宇文明三部曲</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/2024/05/29/39.%5BMS%5DUntargeted_Analysis_on_Tea/">🍵非靶向质谱方法探索各类茶饮的分子组成</a>
            
        </span>
    </div>
    
</article>




<div class="comments">
    <h3 class="title is-4">Comentarios</h3>
    
<script>
    var disqus_config = function () {
        this.page.url = 'http://envhyf.github.io/2024/10/05/30.FLEXPART-trajectories-in-3D-terrain-map/';
        this.page.identifier = '2024/10/05/30.FLEXPART-trajectories-in-3D-terrain-map/';
        
        this.language = 'zh';
        
    };
    (function() {
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'taipingta' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

<div id="disqus_thread">
    
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2025 Hao Yufang&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a
                        target="_blank" rel="noopener" href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" target="_blank" rel="noopener" href="https://github.com/envhyf/">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
            
        </div>
    </div>
</footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery > p > .gallery-item').unwrap();
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    

    



<script src="/js/script.js"></script>


    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Escribe algo..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Posts',
                PAGES: 'Páginas',
                CATEGORIES: 'Categorías',
                TAGS: 'Tags',
                UNTITLED: '(Sin título)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>

<script src="/js/insight.js"></script>

    
</body>
</html>
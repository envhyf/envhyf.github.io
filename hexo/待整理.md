8. 为某一列数据自定义类别，分区。如按照相对湿度将不同时间测量获得的$PM_{2.5}$数据以及能见度数据进行分割。      
			 
```			  
bins = [0,50, 60, 70, 80, 90,100]
group_names = ['<50', '50-60', '60-70', '70-80','80-90','>90']
df['categories'] = pd.cut(df['RH'], bins, labels=group_names)
		  
## PLOT the scatter figure with curve lines by different RH bins
fig = plt.figure()
for i in range(0,len(categories.unique())-1,1):
	ddf = df[df['categories'] == categories.unique()[i]]
	plt.scatter(ddf['PM2.5'], ddf['VISIBILITY'], alpha = 0.45, label ='RH: '+ group_names[i])    
	popt, pcov = curve_fit(func, ddf["PM2.5"], ddf["VISIBILITY"])        
	xdata = np.arange(0, 300, 4)
	plt.plot(xdata, func(xdata, *popt),  zorder =3)
plt.legend(ncol = 2)    
plt.show()    
```	
    


9. 将string 转化为list  
```	    
import ast
x = u'[ "A","B","C","D"]'
x = ast.literal_eval(x)      
```	

10. 一次函数拟合
	
```	
from scipy import stats
import numpy as np
slope, intercept, r_value, p_value, std_err = stats.linregress(x,y)
```	

11. 数据透视表格操作 

```	
mean_.append(off.groupby(['site']).get_group(off.site.unique()[i])['PM25'].mean())
std_.append(off.groupby(['site']).get_group(off.site.unique()[i])['PM25'].std())
```	
    
    

12. Pandas中的条件选择

```	
mask = (met['Date'] < '2016-03-01')|(met['Date'] >= '2016-12-01')
print met.loc[mask]['TEMP'].mean()
```	

13. 排序某个列表

```	
SE_COL =['Cr', 'Co', 'Ni', 'Cu', 'Zn', 'As', 'Se', 'Mo', 'Cd', 'Pb','V','Mg', 'Ca', 'K', 'Ti','Mn', 'Fe', 'Ba', 'Sr']
SE_COL = [SE_COL[t] for t in np.argsort(np.array([vals.dropna().mean() for col, vals in 
        				pm25_ef.iteritems()]))]            
```	        				
        				
14. 去除np.nan, 并找到其第10百分位数

```	
v  = np.isnan(df['value'])
ra_ = (df['value'].values)[~v]
se_index = ra_.argsort().argsort()[:int(0.1*len(df))]
sorted(ra_)[int(0.1*len(ra_))]  
```	

15. 重命名列名称

```	
df.rename(columns={'oldName1': 'newName1', 'oldName2': 'newName2'}, inplace=True)
```	

16. 删除特定列

```	
columns = ['Col1', 'Col2', ...]
df.drop(columns, inplace=True, axis=1)
```	

17. 新增某一列

```	
df[new column name] = pd.Series(Data, index =df.index )
```	

18. 删除含有nan的行

```	
df = df[~np.isfinite('col1')]
```			
  
18. 简易的排序

```			
从大到小    
var_exp = [(i) for i in sorted(eigen_vals, reverse=True)] 
```	
		       
		       
19. 累加函数
			
```	
cum_var_exp = np.cumsum(var_exp)	
```	
		
		
20. 任意函数拟合

```	
from scipy.optimize import curve_fit		
def func(x, a,b):
    return a*x**2+b*x#+0.55
def get_r(f,x,y,popt):
    residuals = y- f(x, *popt)
    ss_res = np.sum(residuals**2)    
    ss_tot = np.sum((y-np.mean(y))**2)    
    r_squared = 1 - (ss_res / ss_tot)
    return r_squared
popt, pcov = curve_fit(func, df['x'], df['y']) 
print "## f(x) = ax**2 +b*x ##"
print "## a##"
print popt
print "## r-square ##"
print get_r(func,df['x'], df['y'], popt )
    
```	
		       


## <font color="blue"> 图像绘制 </font>     


1. 温度符号      

```	
ax.set_ylabel(u'Temperature (\N{DEGREE SIGN}C)', fontweight='bold')
```	
 
2. colorbar的尺度匹配 

```	
from mpl_toolkits.axes_grid1 import make_axes_locatable
divider = make_axes_locatable(ax1)
cax = divider.append_axes("right", size="5%", pad=0.1)
cbar = plt.colorbar(cf, cax=cax)    
cbarlabel = "xxxx"
cbar.ax.set_xlabel(cbarlabel,size = 8,labelpad=-35)

## cbar.ticklabel 调整
conc_list = np.array([50,150,250,])
cbar.set_ticks(conc_list)
cbar.set_ticklabels(conc_list)
## cbar.ticklabel size 调整
cbar.ax.set_xticklabels(cbar.ax.get_xticklabels(), fontsize=8)

```	

3. 中文设置        

```
from matplotlib.font_manager import FontProperties 
## 推荐使用微软雅黑，中英文混排效果比较好
mpl.rcParams['font.sans-serif'] = ['Microsoft YaHei']
plt.rcParams['axes.unicode_minus'] = False
```


## <font color="blue"> 其他功能 </font> 

1. 如何在jupyter中加载某一个script.py文件

```
import os,sys
scriptpath = "/Users/HYF/Downloads/stackoverflow_tag_cloud-master/"

# Add the directory containing your module to the Python path (wants absolute paths)
sys.path.append(os.path.abspath(scriptpath))

# Do the import
import stackoverflow_users_taginfo
from stackoverflow_users_taginfo import taginfo

info = taginfo(link = 4918632, num_tags = 400)
WordCloud().generate_from_frequencies(info).to_image().save('TagCloud.pdf')
```±

2. 查询安装位置    

```
import time
time.__file__
```

3. 如何获得现有的文件路径     

```
script_dir = os.path.dirname(os.path.realpath("ppt-对比两种方法.ipynb")) + os.sep             
``` 
  
  
4. 统计columns中数值的频次和对应数据

```
clu_d['Cluster'].value_counts().to_frame()
clu_d['Cluster'].value_counts().index.tolist()  
```
		
5. 无法保存含有中文字符的csv文件时    
	
```
import sys
reload(sys)
sys.setdefaultencoding('utf-8')		
```

6. 如何双击打开notebook
		
```
#nbopen 插件
python3 -m pip install nbopen
```
    
    
7. resize the picture in jupyter notebook

```
<img src="https://i.stack.imgur.com/kK1LC.png" width="100">
```




cs=cm.Set1(np.arange(7)/7.)
plt.yscale('log')
for axis in [ax.yaxis]:
    axis.set_major_formatter(ScalarFormatter()) 